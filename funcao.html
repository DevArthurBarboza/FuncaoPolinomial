<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<style>
    html{
        width: 100%;
        height: 100%;
        display: flex;
    }
    body{
        box-sizing: border-box;
    }

    .inputs-monomio input{
        width: 250px;
    }

</style>
<body>
    <label for="quantidade_de_monomios">Quantidade de Monomios</label>
    <input id="quantidade_de_monomios" type="number" >    
    <input id="epsilon" placeholder="Informe o épsilon">
    <button onclick="createForm()" id="btn_quantidade_de_monomios">Enviar</button>
    <div style="display:flex;flex-flow: column;" class="inputs-monomio">
    </div>
    
    <!-- <button onclick="addValues()">Adicionar Valores</button> -->
</body>
<script>


const epsilon = document.querySelector('#epsilon').value;
const expoentes = document.querySelector('.inputs-monomio').getElementsByClassName('monomio-exp');
const monomios = document.querySelector('.inputs-monomio').getElementsByClassName('monomio-value');
const range = [-10, 10];



    function createForm(){
        let quantidade_de_monomios = document.querySelector('#quantidade_de_monomios').value
        const listaInputs = []
        
        for(let i=1;i <= quantidade_de_monomios;i++){
            let input = document.createElement('input')
            input.setAttribute('class','monomio-value')
            input.setAttribute('placeholder','Informe o ' + i + '° monomio')
            let inputExp = document.createElement('input')
            inputExp.setAttribute('class','monomio-exp')
            inputExp.setAttribute('placeholder','Informe o expoente do ' + i + '° monomio')
            listaInputs.push(input)
            listaInputs.push(inputExp)
        }
        let div = document.querySelector('.inputs-monomio')
        for(let i=0;i < listaInputs.length;i++){
            div.appendChild(listaInputs[i])
        }
        let buttonSendValue = document.createElement('button')
        buttonSendValue.setAttribute("value","Enviar")
        buttonSendValue.setAttribute("onClick","calc()")
        buttonSendValue.innerText = "Enviar"
        div.appendChild(buttonSendValue)
    }

    function calc(){
        const epsilon = parseFloat(document.querySelector('#epsilon').value)
        const expoentes = document.querySelector('.inputs-monomio').getElementsByClassName('monomio-exp')
        const monomios = document.querySelector('.inputs-monomio').getElementsByClassName('monomio-value')
        let sumOfAllValues
        let range = [-10,10]
        
        let values = []
        let location = []
        let locals;
        let x = 0
        let fx = range[0]
        let prevValue = 0;
        let prevIndex = 0;
        let calc = 0;
        let intervaloB = {"index": undefined ,"value" : undefined};
        let intervaloA = {"index": undefined ,"value" : undefined};

        while(x <= range[1] - range[0]){
            sumOfAllValues = 0;


            for(let i=0;i < monomios.length;i++){
                sumOfAllValues += parseFloat(Math.pow(fx, expoentes[i].value) * monomios[i].value)
            }

            if(prevValue != 0){
                calc = sumOfAllValues * prevValue
            }
         
            let a = sumOfAllValues
            let b = prevValue
            if (calc < 0) {
                let error = 1;

                if(a > 0){
                    intervaloB.value = a
                    intervaloB.index = fx
                    intervaloA.index = fx - 1
                    intervaloA.value = b

                }else{
                    intervaloB.value = b
                    intervaloA.value = a
                    intervaloB.index = fx - 1
                    intervaloA.index = fx

                }
                
                let fm;
                let m = 0;
                while (error > epsilon) {
                    fm = 0;
                    if(m ==0){
                        m = ((fx - 1) + fx ) / 2;
                    }else{
                        m = (intervaloA.index + intervaloB.index) / 2
                    }

                    // m = (intervaloA.value + intervaloB.value ) / 2;
                    for (let i = 0; i < monomios.length; i++) {
                        fm += parseFloat(Math.pow(m, expoentes[i].value) * monomios[i].value);
                    }

                    if(fm < 0){
                        intervaloA.value = fm
                        intervaloA.index = m
                    }else{
                        intervaloB.value = fm
                        intervaloB.index = m
                    }
                    error = Math.abs(Math.abs(intervaloB.index) - Math.abs(intervaloA.index));
                }

                locals = [fx - 1,fx]
                values.push(m)
                location.push(locals)
            }

            prevValue = sumOfAllValues
            prevIndex = fx
            console.log(sumOfAllValues)
            x++
            fx++
        }
            
        let div = document.createElement('div');
        
        let text = document.createTextNode(appendValuesOnIndexes(location,values))
        div.appendChild(text)
        document.getElementsByTagName('body')[0].appendChild(div)
        console.log(values)
         
    }


    function appendValuesOnIndexes(location,values){
        let output = '';
        for(let i = 0; i < values.length;i++){
            
            output += "Raiz " + values[i] + " encontrada entre " + location[i][0] + " e " +  location[i][1]
            output += "\n"

        }
        return output
    }

</script>
</html>